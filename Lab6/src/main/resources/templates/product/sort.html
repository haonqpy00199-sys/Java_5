<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Sorting Toggle</title>
    <style>
        /* CSS Tổng thể */
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 30px; background-color: #fdfdfd; }
        h3 { color: #2c3e50; border-bottom: 2px solid #e74c3c; padding-bottom: 10px; display: inline-block; }

        /* Style cho Bảng */
        table { width: 100%; border-collapse: collapse; background: white; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-top: 20px; }
        th { background-color: #f8f9fa; position: relative; }
        th a {
            display: block; padding: 15px; color: #333; text-decoration: none;
            text-transform: uppercase; font-size: 13px; transition: 0.2s;
        }
        th a:hover { background-color: #e8f4fd; color: #2980b9; }

        td { padding: 12px 15px; border-bottom: 1px solid #eee; color: #555; }
        tr:hover { background-color: #f9f9f9; }

        /* Hiệu ứng mũi tên sắp xếp */
        .sort-icon::after {
            content: "";
            margin-left: 8px;
            font-size: 12px;
        }
        .asc::after { content: "▲"; color: #27ae60; }
        .desc::after { content: "▼"; color: #e74c3c; }

        /* Highlight cột đang được sắp xếp */
        .active-sort { background-color: #eef7ff !important; border-top: 3px solid #3498db; }
    </style>
</head>
<body>

<h3>
    SORTING BY: <span th:text="${field}" style="color: #e74c3c;"></span>
    <small th:text="${currentDir == 'asc' ? '(Tăng dần)' : '(Giảm dần)'}" style="color: #7f8c8d; font-size: 14px;"></small>
</h3>

<table>
    <thead>
    <tr>
        <th th:classappend="${field == 'ID'} ? 'active-sort'">
            <a th:href="@{/product/sort(field='id', dir=${reverseDir})}"
               th:classappend="${field == 'ID'} ? ('sort-icon ' + currentDir)">Id</a>
        </th>
        <th th:classappend="${field == 'NAME'} ? 'active-sort'">
            <a th:href="@{/product/sort(field='name', dir=${reverseDir})}"
               th:classappend="${field == 'NAME'} ? ('sort-icon ' + currentDir)">Name</a>
        </th>
        <th th:classappend="${field == 'PRICE'} ? 'active-sort'">
            <a th:href="@{/product/sort(field='price', dir=${reverseDir})}"
               th:classappend="${field == 'PRICE'} ? ('sort-icon ' + currentDir)">Price</a>
        </th>
        <th th:classappend="${field == 'CREATEDATE'} ? 'active-sort'">
            <a th:href="@{/product/sort(field='createDate', dir=${reverseDir})}"
               th:classappend="${field == 'CREATEDATE'} ? ('sort-icon ' + currentDir)">Date</a>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="p : ${items}">
        <td th:text="${p.id}"></td>
        <td th:text="${p.name}"></td>
        <td th:text="${#numbers.formatDecimal(p.price, 0, 'COMMA', 0, 'POINT')} + ' VNĐ'"></td>
        <td th:text="${#dates.format(p.createDate, 'dd-MM-yyyy')}"></td>
    </tr>
    </tbody>
</table>

<script>
    // JS: Thêm hiệu ứng gợn sóng khi nhấn vào tiêu đề (Optional)
    document.querySelectorAll('th a').forEach(link => {
        link.addEventListener('click', function() {
            this.style.opacity = '0.5';
        });
    });

    // JS: Log kiểm tra trạng thái sắp xếp
    console.log("Đang sắp xếp theo: " + "[[${field}]]" + " - Chiều: " + "[[${currentDir}]]");
</script>
</body>
</html>